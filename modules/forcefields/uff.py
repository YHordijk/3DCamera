import numpy as np
from math import exp, log

class ForceField:
	def __init__(self, molecule):
		self.molecule = molecule

		###parameters:
		self.valence_bond = {
			'H_': 0.354,
			'H_b': 0.460,
			'He4+4': 0.849,
			'Li': 1.336,
			'Be3+2': 1.074,
			'B_3': 0.838,
			'B_2': 0.828,
			'C_3': 0.757,
			'C_R': 0.729,
			'C_2': 0.732,
			'C_1': 0.706,
			'N_3': 0.700,
			'N_R': 0.699,
			'N_2': 0.685,
			'N_1': 0.656,
			'O_3': 0.658,
			'O_3_z': 0.528,
			'O_R': 0.680,
			'O_2': 0.634,
			'O_1': 0.639,
			'F_': 0.668,
			'Ne4+4': 0.920,
		}

		self.valence_angle = {
			'H_': 180,
			'H_b': 83.5,
			'He4+4': 90,
			'Li': 180,
			'Be3+2': 109.47,
			'B_3': 109.47,
			'B_2': 120,
			'C_3': 109.47,
			'C_R': 120,
			'C_2': 120,
			'C_1': 180,
			'N_3': 106.7,
			'N_R': 120,
			'N_2': 111.2,
			'N_1': 180,
			'O_3': 104.51,
			'O_3_z': 146,
			'O_R': 110,
			'O_2': 120,
			'O_1': 180,
			'F_': 180,
			'Ne4+4': 90,
		}

		self.nonbond_distance = {
			'H_': 2.886,
			'H_b': 2.886,
			'He4+4': 2.362,
			'Li': 2.451,
			'Be3+2': 2.745,
			'B_3': 4.083,
			'B_2': 4.083,
			'C_3': 3.851,
			'C_R': 3.851,
			'C_2': 3.851,
			'C_1': 3.851,
			'N_3': 3.660,
			'N_R': 3.660,
			'N_2': 3.660,
			'N_1': 3.660,
			'O_3': 3.500,
			'O_3_z': 3.500,
			'O_R': 3.500,
			'O_2': 3.500,
			'O_1': 3.500,
			'F_': 3.364,
			'Ne4+4': 3.243,
		}

		self.nonbond_energy = {
			'H_': 0.044,
			'H_b': 0.044,
			'He4+4': 0.056,
			'Li': 0.025,
			'Be3+2': 0.085,
			'B_3': 0.180,
			'B_2': 0.180,
			'C_3': 0.105,
			'C_R': 0.105,
			'C_2': 0.105,
			'C_1': 0.105,
			'N_3': 0.069,
			'N_R': 0.069,
			'N_2': 0.069,
			'N_1': 0.069,
			'O_3': 0.060,
			'O_3_z': 0.060,
			'O_R': 0.060,
			'O_2': 0.060,
			'O_1': 0.060,
			'F_': 0.050,
			'Ne4+4': 0.042,
		}

		self.nonbond_scale = {
			'H_': 12,
			'H_b': 12,
			'He4+4': 15.24,
			'Li': 12,
			'Be3+2': 12,
			'B_3': 12.052,
			'B_2': 12.052,
			'C_3': 12.73,
			'C_R': 12.73,
			'C_2': 12.73
			'C_1': 12.73,
			'N_3': 13.407,
			'N_R': 13.407,
			'N_2': 13.407,
			'N_1': 13.407,
			'O_3': 14.085,
			'O_3_z': 14.085,
			'O_R': 14.085,
			'O_2': 14.085,
			'O_1': 14.085,
			'F_': 14.762,
			'Ne4+4': 15.440,
		}

		self.effective_charge = {
			'H_': 0.712,
			'H_b': 0.712,
			'He4+4': 0.098,
			'Li': 1.026,
			'Be3+2': 1.565,
			'B_3': 1.755,
			'B_2': 1.755,
			'C_3': 1.912,
			'C_R': 1.912,
			'C_2': 1.912
			'C_1': 1.912,
			'N_3': 2.544,
			'N_R': 2.544,
			'N_2': 2.544,
			'N_1': 2.544,
			'O_3': 2.300,
			'O_3_z': 2.300,
			'O_R': 2.300,
			'O_2': 2.300,
			'O_1': 2.300,
			'F_': 1.735,
			'Ne4+4': 0.194,
		}

		self.torsional_barrier_params = {
			'C_3': 2.119,
			'N_3': 0.450,
			'O_3': 0.018,
			'Si3': 1.225,
			'P_3': 2.400,
			'S_3': 0.484,
			'Ge3': 0.701,
			'As3': 1.500,
			'Se3': 0.335,
			'Sn3': 0.199,
			'Sb3': 1.100,
			'Te3': 0.300,
			'Pb3': 0.100,
			'Bi3': 1.000,
			'Po3': 0.300,
		}

